
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Electrically-Coupled Nanoantenna Resonators &#8212; Technical Notes to Self</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Surface Plasmon Polariton Mode Dispersion with Derivation" href="../../NOTE-2022-04-12-surface-plasmon-polariton-mode-dispersion/ipynb/note.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Technical Notes to Self</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Technical Notes to Self
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../NOTE-2022-03-30-short-cable-impedance-tline-vs-lumped-element/ipynb/note.html">
   Short Cable Impedance – T-Line vs. Lumped Element Approximation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../NOTE-2022-04-04-hemoglobin-refractive-index-vis-nir/ipynb/note.html">
   Kramers Kronig Analysis and Refractive Index of Hemoglobin/Red Blood Cells
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../NOTE-2022-04-12-surface-plasmon-polariton-mode-dispersion/ipynb/note.html">
   Surface Plasmon Polariton Mode Dispersion with Derivation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Electrically-Coupled Nanoantenna Resonators
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/dkeathley/notes-to-self/main?urlpath=tree/NOTE-2022-11-27-coupled-oscillators/ipynb/note-resonances-in-coupled-nanoantennas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/dkeathley/notes-to-self/blob/main/NOTE-2022-11-27-coupled-oscillators/ipynb/note-resonances-in-coupled-nanoantennas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/dkeathley/notes-to-self"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/dkeathley/notes-to-self/issues/new?title=Issue%20on%20page%20%2FNOTE-2022-11-27-coupled-oscillators/ipynb/note-resonances-in-coupled-nanoantennas.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/NOTE-2022-11-27-coupled-oscillators/ipynb/note-resonances-in-coupled-nanoantennas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivating-the-circuit-model">
   Motivating the Circuit Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transmission-line-model">
   Transmission Line Model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pulse-setup">
     Pulse Setup
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-antenna-parameters">
     Setting Antenna Parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connecting-with-a-transmission-line-initial-guess-as-twin-lead-t-line">
     Connecting With a Transmission Line: Initial Guess as Twin-Lead T-Line
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Electrically-Coupled Nanoantenna Resonators</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivating-the-circuit-model">
   Motivating the Circuit Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transmission-line-model">
   Transmission Line Model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pulse-setup">
     Pulse Setup
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-antenna-parameters">
     Setting Antenna Parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connecting-with-a-transmission-line-initial-guess-as-twin-lead-t-line">
     Connecting With a Transmission Line: Initial Guess as Twin-Lead T-Line
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="electrically-coupled-nanoantenna-resonators">
<h1>Electrically-Coupled Nanoantenna Resonators<a class="headerlink" href="#electrically-coupled-nanoantenna-resonators" title="Permalink to this headline">#</a></h1>
<p>In this note we explore two nanoantenna resonators that are electrically connected with similarly-scaled wires.  The approach is to capture the salient physics of the coupled resonant dynamics using effective circuit models.  This approach is motivated by the fact that one can model each antenna’s resonance as a damped harmonic oscillator <span id="id1">[<a class="reference internal" href="#id938" title="Bernd Metzger, Mario Hentschel, Markus Lippitz, and Harald Giessen. Third-harmonic spectroscopy and modeling of the nonlinear response of plasmonic nanoantennas. Optics Letters, 37(22):4741–4743, November 2012. doi:10.1364/OL.37.004741.">1</a>, <a class="reference internal" href="#id542" title="Mario Hentschel, Tobias Utikal, Harald Giessen, and Markus Lippitz. Quantitative Modeling of the Third Harmonic Emission Spectrum of Plasmonic Nanoantennas. Nano Letters, 12(7):3778–3782, July 2012. doi:10.1021/nl301686x.">2</a>, <a class="reference internal" href="#id1111" title="William P. Putnam, Richard G. Hobbs, Phillip D. Keathley, Karl K. Berggren, and Franz X. Kärtner. Optical-field-controlled photoemission from plasmonic nanoparticles. Nature Physics, 13(4):335–339, April 2017. doi:10.1038/nphys3978.">3</a>, <a class="reference internal" href="#id705" title="P. D. Keathley, W. P. Putnam, P. Vasireddy, R. G. Hobbs, Y. Yang, K. K. Berggren, and F. X. Kärtner. Vanishing carrier-envelope-phase-sensitive response in optical-field photoemission from plasmonic nanoantennas. Nature Physics, 15(11):1128–1133, November 2019. doi:10.1038/s41567-019-0613-6.">4</a>]</span>.  We see that this can be modeled by an RLC circuit in series with the intuition that the external optical fields drive the system.</p>
<p>In the following, we start with development of the effective circuit model and provide physical motivation. We build up from a single antenna, to two coupled antennas that are attached via twin leads.  We then drive the system and study the outputs to investigate the physics, and explore how coupling impacts the resulting local fields at each antenna.</p>
<section id="motivating-the-circuit-model">
<h2>Motivating the Circuit Model<a class="headerlink" href="#motivating-the-circuit-model" title="Permalink to this headline">#</a></h2>
<p>We can imagine that charges oscillate in the antenna structure as driven the the exciting E-field.  In <a class="reference internal" href="#fig-single-antenna-rlc"><span class="std std-numref">Fig. 1</span></a> we a point of maximum charge separation and the resulting external field lines.  The external field lines lead to a capacitive coupling between the top and bottom of the antenna.  Furthermore, as the charges move through the antenna, there is loss and induction.  This leads to the effective circuit model on the right.  The electric field waveform can be mapped directly to an effective voltage waveform that drives the effective RLC in series.</p>
<figure class="align-default" id="fig-single-antenna-rlc">
<a class="reference internal image-reference" href="../../_images/single-antenna-rlc.png"><img alt="../../_images/single-antenna-rlc.png" src="../../_images/single-antenna-rlc.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">The effective circuit model for a single antenna.</span><a class="headerlink" href="#fig-single-antenna-rlc" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Note that as the capacitance maps directly to the fields surrounding the antenna structure, we interpret that the fields surrounding the antenna structure should map with a one-to-one correspondence with the voltage on the capacitor.  Indeed, we find that the voltage on the capacitance can be written as:</p>
<div class="math notranslate nohighlight">
\[ V_C = \frac{\tilde{V}(\omega)}{1 - \omega^2 C L + j\omega C R} \mathrm{.}\]</div>
<p>This then relates directly to the known enhanced field response at the tip for instance which can be expressed as</p>
<div class="math notranslate nohighlight">
\[ \tilde{E}_\mathrm{tip}(\omega) \propto \frac{\tilde{E}_\mathrm{inc}(\omega)}{\omega_\mathrm{res}^2 - \omega^2 - j\omega/\tau} \mathrm{,} \]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is the damping time and <span class="math notranslate nohighlight">\(\omega_\mathrm{res}\)</span> the resonance frequency of the oscillator.</p>
<p>Interestingly, one might think that adding in new elements would make the situation significantly more complicated.  Consider the addition of a wire at the bottom of the antenna tip as shown in <a class="reference internal" href="#fig-single-antenna-wire-rlc"><span class="std std-numref">Fig. 2</span></a>.</p>
<figure class="align-default" id="fig-single-antenna-wire-rlc">
<a class="reference internal image-reference" href="../../_images/antenna-wire-rlc.png"><img alt="../../_images/antenna-wire-rlc.png" src="../../_images/antenna-wire-rlc.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">The effective circuit model for a single antenna with a wire.</span><a class="headerlink" href="#fig-single-antenna-wire-rlc" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Here, we can roughly define three regions with effective capacitance, now considering the system with the wire coupled to it.  There is the body capacitance <span class="math notranslate nohighlight">\(C_\mathrm{B}\)</span>, the wire to body capacitance <span class="math notranslate nohighlight">\(C_\mathrm{W}\)</span> and the tip to wire gap capacitance <span class="math notranslate nohighlight">\(C_\mathrm{g}\)</span>. We realize this is already simplified in ignoring any resistance or inductance in the wire itself.</p>
<p>Since we are usually concerning ourselves with the enhanced fields in the gap of the antenna for applications, we can solve for those by then solving for <span class="math notranslate nohighlight">\(V_\mathrm{g}\)</span> the voltage on <span class="math notranslate nohighlight">\(C_\mathrm{g}\)</span>.  With a bit of work we find this is expressed as:</p>
<div class="math notranslate nohighlight">
\[ \tilde{V}_\mathrm{g}(\omega) = \frac{\tilde{V}(\omega)}{j \omega AC_\mathrm{g}R - \omega^2 A L C_\mathrm{g}
   + C_\mathrm{g}/C_\mathrm{b} (A - 1) } \]</div>
<p>The <span class="math notranslate nohighlight">\(A\)</span> here is</p>
<div class="math notranslate nohighlight">
\[ A = \frac{C_g C_w}{C_g C_w + C_b C_w + C_b C_g} \mathrm{,}\]</div>
<p>which comes directly from the coupled-capacitor network at the bottom of the effective circuit.</p>
<p>Note that to within a constant multiple (i.e. modified strength of voltage excitation), this can be rewritten as the response of an RLC in series, thus significantly simplifying our problem.  This justifies later substitutions where we switch to a simplified, effective series RLC model despite the addition of collector wires.  While this may seem very simplified, it is incredibly powerful.  Several past works <span id="id2">[<a class="reference internal" href="#id938" title="Bernd Metzger, Mario Hentschel, Markus Lippitz, and Harald Giessen. Third-harmonic spectroscopy and modeling of the nonlinear response of plasmonic nanoantennas. Optics Letters, 37(22):4741–4743, November 2012. doi:10.1364/OL.37.004741.">1</a>, <a class="reference internal" href="#id542" title="Mario Hentschel, Tobias Utikal, Harald Giessen, and Markus Lippitz. Quantitative Modeling of the Third Harmonic Emission Spectrum of Plasmonic Nanoantennas. Nano Letters, 12(7):3778–3782, July 2012. doi:10.1021/nl301686x.">2</a>]</span>, including those of ours <span id="id3">[<a class="reference internal" href="#id1111" title="William P. Putnam, Richard G. Hobbs, Phillip D. Keathley, Karl K. Berggren, and Franz X. Kärtner. Optical-field-controlled photoemission from plasmonic nanoparticles. Nature Physics, 13(4):335–339, April 2017. doi:10.1038/nphys3978.">3</a>, <a class="reference internal" href="#id705" title="P. D. Keathley, W. P. Putnam, P. Vasireddy, R. G. Hobbs, Y. Yang, K. K. Berggren, and F. X. Kärtner. Vanishing carrier-envelope-phase-sensitive response in optical-field photoemission from plasmonic nanoantennas. Nature Physics, 15(11):1128–1133, November 2019. doi:10.1038/s41567-019-0613-6.">4</a>]</span>, have shown that the fields that build up on the capictive element can be tuned to quantitatively predict the temporal profile of a plasmonic resonator despite varying shape. In particular in <span id="id4">[<a class="reference internal" href="#id542" title="Mario Hentschel, Tobias Utikal, Harald Giessen, and Markus Lippitz. Quantitative Modeling of the Third Harmonic Emission Spectrum of Plasmonic Nanoantennas. Nano Letters, 12(7):3778–3782, July 2012. doi:10.1021/nl301686x.">2</a>]</span> it was shown that this same model applies to bow-tie elements just as well as single antennas, thus motivating our analysis above that the general transofrmation from the incident electric field waveform to local fields can be expressed as a simplified, effective series RLC model.</p>
<p>We note that all of the paramters can be fit phenomenologically based on comparisons to experimental and/or simulation data.  Wherever possible in our simulations below, however, we motivate parameter choices using first-principles.</p>
</section>
<section id="transmission-line-model">
<h2>Transmission Line Model<a class="headerlink" href="#transmission-line-model" title="Permalink to this headline">#</a></h2>
<p>Now that we have the effective circuit models for the individual resonators, we can add the next layer of coplexity: the connecting wires.  These wires behave more like transmission lines as they can couple traveling waves.  This is important as if the wires get longer, they can cary waves over a macroscopic distance.  This induces a propagation delay that coudl be observed.  Also, it leads to a different profile in the resonant waveform that gets induced across both sets of antennas.</p>
<p>Here we model a pair of antennas connected via a transmission line.  The antennas follow the coupled oscillator approach similar to above.  However, now, instead of a lumped element coupler, we use a finite-length transmission-line coupler between the antenna pair.</p>
<p>A sketch of the physical device and its effective circuit model that we will use are shown in <a class="reference internal" href="#fig-effective-t-line-ckt"><span class="std std-numref">Fig. 3</span></a>.</p>
<figure class="align-default" id="fig-effective-t-line-ckt">
<a class="reference internal image-reference" href="../../_images/t-line-effective-ckt.png"><img alt="../../_images/t-line-effective-ckt.png" src="../../_images/t-line-effective-ckt.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">An effective circuit for two coupled oscillators connected by a transmission line.  Forward and backward waves create reflection effects, and couple the two oscillators together.</span><a class="headerlink" href="#fig-effective-t-line-ckt" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Below we outline our procedure for modeling the coupled resonators, including the selection of effective parameters for the circuit models.  This analysis can easily be extended, and full-wave simulations and experimental data can be used to tune-in the effective system parameters.</p>
<section id="pulse-setup">
<h3>Pulse Setup<a class="headerlink" href="#pulse-setup" title="Permalink to this headline">#</a></h3>
<p>We start by defining a waveform to drive each antenna.  These are defined as <span class="math notranslate nohighlight">\(V_1(t)\)</span> and <span class="math notranslate nohighlight">\(V_2(t)\)</span> for antenna 1 and antenna 2. These voltage waveforms are directly proportional to the incident electric field driving the antennas.  Below, we sert the pulses so that they more closely match what we are experimentally capable of generating in our laboratory, but these could of course be tuned for any duration and wavelength.</p>
<div class="admonition-a-note-on-units-in-the-code admonition">
<p class="admonition-title">A Note on Units in the Code</p>
<p>For convenience in all of the code below we use a modified unit system defined using the natural length scales of the problem: nanometers and femtoseconds.  Where relevant we denote the nm-fs units are denoted as SI units with an n subscript.</p>
<p>This nm-fs unit system leads to the conversions shown in <a class="reference internal" href="#nm-fs-conversion-table"><span class="std std-numref">Table 1</span></a>.</p>
<table class="colwidths-auto table" id="nm-fs-conversion-table">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Conversion from SI to nm-fs units for the calculations that follow.</span><a class="headerlink" href="#nm-fs-conversion-table" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>SI Unit</p></th>
<th class="head"><p>nm-fs units</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Capacitance</p></td>
<td><p>F</p></td>
<td><p><span class="math notranslate nohighlight">\(10^{12}\)</span> F<sub>n</sub></p></td>
</tr>
<tr class="row-odd"><td><p>Inductance</p></td>
<td><p>H</p></td>
<td><p><span class="math notranslate nohighlight">\(10^{18}\)</span> H<sub>n</sub></p></td>
</tr>
<tr class="row-even"><td><p>Resistance</p></td>
<td><p><span class="math notranslate nohighlight">\(\Omega\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10^{3}\)</span> <span class="math notranslate nohighlight">\(\Omega\)</span><sub>n</sub></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\epsilon_0\)</span></p></td>
<td><p>F/m</p></td>
<td><p><span class="math notranslate nohighlight">\(10^{3}\)</span> F<sub>n</sub>/nm</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mu_0\)</span></p></td>
<td><p>H/m</p></td>
<td><p><span class="math notranslate nohighlight">\(10^{9}\)</span> H<sub>n</sub>/nm</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../includes&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pulse_functions</span> <span class="k">as</span> <span class="nn">pulses</span>

<span class="c1"># -- Constants -- </span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1">#Speed of light in nm/fs</span>
<span class="n">eps0</span> <span class="o">=</span> <span class="mf">8.85418782e-12</span><span class="o">*</span><span class="mf">1e3</span> <span class="c1">#permittivity of freespace in nm, fs units</span>
<span class="n">mu0</span> <span class="o">=</span> <span class="mf">1.25663706e-6</span><span class="o">*</span><span class="mf">1e9</span> <span class="c1">#permeability of freespace in nm, fs units</span>

<span class="c1"># -- Settings -- </span>

<span class="c1">#Time axis in femtoseconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>

<span class="c1">#FWHM in fs</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">12</span> 

<span class="c1">#Central wavelength in nm</span>
<span class="n">yc</span> <span class="o">=</span> <span class="mi">1170</span> 

<span class="c1">#Phase delay</span>
<span class="n">phaseDelay</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>

<span class="c1"># ------------------------------</span>

<span class="c1"># -- Calculations -- </span>
<span class="n">fc</span> <span class="o">=</span> <span class="n">c</span><span class="o">/</span><span class="n">yc</span>
<span class="n">wc</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fc</span>

<span class="c1">#Incident pulses for each side:</span>
<span class="n">V1</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">pulses</span><span class="o">.</span><span class="n">cos2pulse</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">wc</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
<span class="n">V2</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">pulses</span><span class="o">.</span><span class="n">cos2pulse</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">wc</span><span class="p">,</span> <span class="n">phaseDelay</span><span class="p">)[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>


<span class="c1"># -- Plots -- </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V1</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">V2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;V(t) (V)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_9_0.png" src="../../_images/note-resonances-in-coupled-nanoantennas_9_0.png" />
</div>
</div>
</section>
<section id="setting-antenna-parameters">
<h3>Setting Antenna Parameters<a class="headerlink" href="#setting-antenna-parameters" title="Permalink to this headline">#</a></h3>
<p>For our model, we need to select effective circuit parameters.  Experimentally there are two observables of interest:</p>
<ol class="simple">
<li><p>The resonance frequency <span class="math notranslate nohighlight">\(\omega_\mathrm{res}\)</span></p></li>
<li><p>The damping time of the resonance <span class="math notranslate nohighlight">\(\tau\)</span></p></li>
</ol>
<p>The resonance frequency and damping time can be fit by using extinction spectra or a combination of extinction spectra and other means.  More recently we have demonstrated the ability to fit both the damping time and resonance frequency using optical field sampling techniques (see <span id="id5">[<a class="reference internal" href="#id129" title="Mina R. Bionta, Felix Ritzkowsky, Marco Turchetti, Yujia Yang, Dario Cattozzo Mor, William P. Putnam, Franz X. Kärtner, Karl K. Berggren, and Phillip D. Keathley. On-chip sampling of optical fields with attosecond resolution. Nature Photonics, 15(6):456–460, June 2021. doi:10.1038/s41566-021-00792-0.">5</a>]</span>).  Given that in all cases these experimentally observed values match very well to full-wave electromagnetic simulation, full-wave models (<em>e.g.</em> FDTD or FEM) could just as well be used.</p>
<p>Unfortunately, knowledge of the damping time <span class="math notranslate nohighlight">\(\tau\)</span> and resonance frequency <span class="math notranslate nohighlight">\(\omega_\mathrm{res}\)</span> does not uniquely determine <span class="math notranslate nohighlight">\(R\)</span>, <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(C\)</span>.  However, we can estimate <span class="math notranslate nohighlight">\(C\)</span> by performing simulation analysis of the structure.  Then from this definition of <span class="math notranslate nohighlight">\(C\)</span>, we can uniquely determine <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(L\)</span> through the following relations.</p>
<div class="math notranslate nohighlight">
\[ L = \frac{1}{\omega_\mathrm{res}^2 C} \mathrm{,}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ R = \frac{L}{\tau} \mathrm{.}\]</div>
<p>Our initial guess for the antenna parameters are:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\tau = 6\)</span> fs</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_\mathrm{res} = \frac{2\pi c}{\omega_\mathrm{res}} = 1100\)</span> nm</p></li>
<li><p><span class="math notranslate nohighlight">\(C = 10\)</span> aF</p></li>
</ol>
<p>Below we calculate the effective circuit parameters based on this intial guess for both the first and second antenna in the coupled antenna network.  For now we choose identical parameters, but leave the code general below so you can play with setting these differently.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau1</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">yres1</span> <span class="o">=</span> <span class="mi">1100</span>
<span class="n">C1</span> <span class="o">=</span> <span class="mf">10e-18</span><span class="o">*</span><span class="mf">1e12</span>

<span class="n">tau2</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">yres2</span> <span class="o">=</span> <span class="mi">1100</span>
<span class="n">C2</span> <span class="o">=</span> <span class="mf">10e-18</span><span class="o">*</span><span class="mf">1e12</span>

<span class="c1"># -- Calculations -- </span>

<span class="c1">#First Antenna</span>
<span class="n">wres1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">c</span><span class="o">/</span><span class="n">yres1</span>
<span class="n">L1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">wres1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">C1</span><span class="p">)</span>
<span class="n">R1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">wres1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">tau1</span><span class="o">*</span><span class="n">C1</span><span class="p">)</span>

<span class="c1">#Second Antenna</span>
<span class="n">wres2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">c</span><span class="o">/</span><span class="n">yres2</span>
<span class="n">L2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">wres1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">C2</span><span class="p">)</span>
<span class="n">R2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">wres1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">tau1</span><span class="o">*</span><span class="n">C2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First Antenna&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  L1 = &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">L1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; H_n&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  R1 = &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; Ohm_n&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Second Antenna&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  L2 = &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; H_n&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  R2 = &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; Ohm_n&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First Antenna
--------------
  L1 = 34055.18 H_n
  R1 = 6811.04 Ohm_n

Second Antenna
---------------
  L2 = 34055.18 H_n
  R2 = 6811.04 Ohm_n
</pre></div>
</div>
</div>
</div>
<p>Next we examine the excited wave at each antenna given no transmission line (i.e. no coupling between the resonators). The field at the antenna is diretly proportional to the voltage waveform on the capacitor, which is what we study here. We plot the field at each antenna side by side.  Again, you can see what happens yourself if you change the relative parameters of each antenna to make them different.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -- Calculations -- </span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="n">w</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1e-18</span>


<span class="n">V1f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">V1</span><span class="p">)</span>
<span class="n">Vin1f</span> <span class="o">=</span> <span class="n">V1f</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">C1</span><span class="o">*</span><span class="n">L1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">C1</span><span class="o">*</span><span class="n">R1</span><span class="p">)</span>
<span class="n">Vin1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">Vin1f</span><span class="p">))</span>


<span class="n">V2f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">V2</span><span class="p">)</span>
<span class="n">Vin2f</span> <span class="o">=</span> <span class="n">V2f</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">C2</span><span class="o">*</span><span class="n">L2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">C2</span><span class="o">*</span><span class="n">R2</span><span class="p">)</span>
<span class="n">Vin2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">Vin2f</span><span class="p">))</span>

<span class="c1"># -- Plots -- </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">V1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Vin1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Vin1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;excited&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">V2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">V2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Vin2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Vin2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;excited&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$V_\mathrm</span><span class="si">{g}</span><span class="s1">(t)$ (V)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Left Resonator Waveforms&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$V_\mathrm</span><span class="si">{g}</span><span class="s1">(t)$ (V)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Right Resonator Waveforms&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_14_0.png" src="../../_images/note-resonances-in-coupled-nanoantennas_14_0.png" />
</div>
</div>
</section>
<section id="connecting-with-a-transmission-line-initial-guess-as-twin-lead-t-line">
<h3>Connecting With a Transmission Line: Initial Guess as Twin-Lead T-Line<a class="headerlink" href="#connecting-with-a-transmission-line-initial-guess-as-twin-lead-t-line" title="Permalink to this headline">#</a></h3>
<p>Now we are going to connect the two antennas with a transmission line.  We will start with the approximation of the wire as a twin-lead T-line. This may not be a perfect model, but it serves its purpose as the model above for the resonators did – it allows us to get to an effective model that captures the salient physics with experimentally relevant parameters.</p>
<p>For the transmission line to be defined, we need to calculate effective impedance <span class="math notranslate nohighlight">\(Z_0\)</span>, and the propagation constant <span class="math notranslate nohighlight">\(\beta\)</span> from the twin-lead equations.  For reference, the definition of these parameters with respect to the wire geometry were taken from <a class="reference external" href="https://eng.libretexts.org/Bookshelves/Electrical_Engineering/Electro-Optics/Book%3A_Electromagnetics_II_(Ellingson)/07%3A_Transmission_Lines_Redux/7.01%3A_Parallel_Wire_Transmission_Line">here</a>.</p>
<p>While this twin-lead approximation is clearly a simplified formalism, it captures the physics quite well, and the waveforms we see bear a striking resemblance to those from full-wave simulations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -- Settings -- </span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">200</span> <span class="c1">#wire spacing</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1">#wire width</span>
<span class="n">l</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1">#wire length</span>
<span class="n">epsr</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="c1">#Effective permittivity</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3000</span> <span class="c1">#loss parameter</span>
<span class="c1">#alpha = 1 #High loss -- no coupling</span>

<span class="n">P1</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1">#Amount of R and L the line sees</span>
<span class="n">P2</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="c1"># -- Calculations -- </span>
<span class="n">Lp</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu0</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">D</span><span class="o">/</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">D</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">Cp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">eps0</span><span class="o">*</span><span class="n">epsr</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">D</span><span class="o">/</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">D</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1">#Split impedances:</span>
<span class="n">Rt1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">P1</span><span class="p">)</span><span class="o">*</span><span class="n">R1</span>
<span class="n">Rb1</span> <span class="o">=</span> <span class="n">P1</span><span class="o">*</span><span class="n">R1</span>
<span class="n">Lt1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">P1</span><span class="p">)</span><span class="o">*</span><span class="n">L1</span>
<span class="n">Lb1</span> <span class="o">=</span> <span class="n">P1</span><span class="o">*</span><span class="n">L1</span>

<span class="n">Zt1</span> <span class="o">=</span> <span class="n">Rt1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">Lt1</span>
<span class="n">Zb1</span> <span class="o">=</span> <span class="n">Rb1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">Lb1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">C1</span><span class="p">)</span>

<span class="n">Rt2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">P2</span><span class="p">)</span><span class="o">*</span><span class="n">R2</span>
<span class="n">Rb2</span> <span class="o">=</span> <span class="n">P2</span><span class="o">*</span><span class="n">R2</span>
<span class="n">Lt2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">P2</span><span class="p">)</span><span class="o">*</span><span class="n">L2</span>
<span class="n">Lb2</span> <span class="o">=</span> <span class="n">P2</span><span class="o">*</span><span class="n">L2</span>

<span class="n">Zt2</span> <span class="o">=</span> <span class="n">Rt2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">Lt2</span>
<span class="n">Zb2</span> <span class="o">=</span> <span class="n">Rb2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">Lb2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">C2</span><span class="p">)</span>

<span class="c1">#Line impedance and velocity</span>
<span class="n">Z0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Lp</span><span class="o">/</span><span class="n">Cp</span><span class="p">)</span> <span class="c1">#impedance</span>
<span class="n">v</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Lp</span><span class="o">*</span><span class="n">Cp</span><span class="p">)</span> <span class="c1">#velocity</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">v</span> <span class="c1">#propagation constant</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T-Line Properties&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Z0 = &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Z0</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; Ohm_n/nm&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  beta = &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; rad/nm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T-Line Properties
-------------------
  Z0 = 293071.86 Ohm_n/nm
  beta = 6811.04 rad/nm
</pre></div>
</div>
</div>
</div>
<p>After determining all of the transmission line characteristics, we now move forward to calculating the voltage response at each antenna with the transmission line in place.  This requires:</p>
<ol class="simple">
<li><p>Calculation of the reflectivity at the load <span class="math notranslate nohighlight">\(\Gamma_L\)</span></p></li>
<li><p>Determine effictive load impedance at the source side <span class="math notranslate nohighlight">\(Z_\mathrm{in}\)</span></p></li>
<li><p>Propagation of the input voltage back to the load side using telegrapher’s equations</p></li>
</ol>
<p>Since the system is linear, we do this calculation twice: once with the right source off, and once with the left source off.  We then add the result of each together to find the total driven response when both sources are active simultaneously.</p>
<p>In the code snippet below, we perform all fo the relevant calcualtions based on the antenna properties, transmission-line properties, and source definitions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Load impedance at 2 as seen by source at 1</span>

<span class="n">ZL1</span> <span class="o">=</span> <span class="n">Zt2</span><span class="o">*</span><span class="n">Zb2</span><span class="o">/</span><span class="p">(</span><span class="n">Zt2</span> <span class="o">+</span> <span class="n">Zb2</span><span class="p">)</span>

<span class="n">Gamma1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZL1</span> <span class="o">-</span> <span class="n">Z0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ZL1</span> <span class="o">+</span> <span class="n">Z0</span><span class="p">)</span>

<span class="n">Zin1</span> <span class="o">=</span> <span class="n">Z0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Gamma1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">l</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Gamma1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">l</span><span class="p">))</span>

<span class="n">Zp1</span> <span class="o">=</span> <span class="n">Zb1</span><span class="o">*</span><span class="n">Zin1</span><span class="o">/</span><span class="p">(</span><span class="n">Zb1</span> <span class="o">+</span> <span class="n">Zin1</span><span class="p">)</span>

<span class="n">Vin1f</span> <span class="o">=</span> <span class="n">V1f</span><span class="o">*</span><span class="n">Zp1</span><span class="o">/</span><span class="p">(</span><span class="n">Zt1</span> <span class="o">+</span> <span class="n">Zp1</span><span class="p">)</span>

<span class="n">Vplus1f</span> <span class="o">=</span> <span class="n">Vin1f</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="n">Gamma1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">l</span><span class="p">))</span>
<span class="n">Vo21f</span> <span class="o">=</span> <span class="n">Vplus1f</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Gamma1</span><span class="p">)</span>

<span class="n">Vg1f</span> <span class="o">=</span> <span class="n">Vin1f</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">C1</span><span class="o">*</span><span class="p">(</span><span class="n">Rb1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">Lb1</span><span class="p">))</span>
<span class="n">Vg21f</span> <span class="o">=</span> <span class="n">Vo21f</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">C2</span><span class="o">*</span><span class="p">(</span><span class="n">Rb2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">Lb2</span><span class="p">))</span>

<span class="n">Vg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">Vg1f</span><span class="p">))</span>
<span class="n">Vg21</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">Vg21f</span><span class="p">))</span>

<span class="c1"># -- Plots -- </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># ax2 = fig.add_subplot(1, 2, 2)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Vg1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;C1 Voltage&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Vg21</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;C2 Voltage&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">65</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;V(t) (V)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Voltages from Source 1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_19_0.png" src="../../_images/note-resonances-in-coupled-nanoantennas_19_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Load impedance at 2 as seen by source at 1</span>

<span class="n">ZL2</span> <span class="o">=</span> <span class="n">Zt1</span><span class="o">*</span><span class="n">Zb1</span><span class="o">/</span><span class="p">(</span><span class="n">Zt1</span> <span class="o">+</span> <span class="n">Zb1</span><span class="p">)</span>

<span class="n">Gamma2</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZL2</span> <span class="o">-</span> <span class="n">Z0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ZL2</span> <span class="o">+</span> <span class="n">Z0</span><span class="p">)</span>

<span class="n">Zin2</span> <span class="o">=</span> <span class="n">Z0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Gamma2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">l</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Gamma2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">l</span><span class="p">))</span>

<span class="n">Zp2</span> <span class="o">=</span> <span class="n">Zb2</span><span class="o">*</span><span class="n">Zin2</span><span class="o">/</span><span class="p">(</span><span class="n">Zb2</span> <span class="o">+</span> <span class="n">Zin2</span><span class="p">)</span>

<span class="n">Vin2f</span> <span class="o">=</span> <span class="n">V2f</span><span class="o">*</span><span class="n">Zp2</span><span class="o">/</span><span class="p">(</span><span class="n">Zt2</span> <span class="o">+</span> <span class="n">Zp2</span><span class="p">)</span>

<span class="n">Vplus2f</span> <span class="o">=</span> <span class="n">Vin2f</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="n">Gamma2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">l</span><span class="p">))</span>
<span class="n">Vo12f</span> <span class="o">=</span> <span class="n">Vplus2f</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Gamma2</span><span class="p">)</span>

<span class="n">Vg2f</span> <span class="o">=</span> <span class="n">Vin2f</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">C2</span><span class="o">*</span><span class="p">(</span><span class="n">Rb2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">Lb2</span><span class="p">))</span>
<span class="n">Vg12f</span> <span class="o">=</span> <span class="n">Vo12f</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">C1</span><span class="o">*</span><span class="p">(</span><span class="n">Rb1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">Lb1</span><span class="p">))</span>

<span class="n">Vg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">Vg2f</span><span class="p">))</span>
<span class="n">Vg12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">Vg12f</span><span class="p">))</span>

<span class="c1"># -- Plots -- </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># ax2 = fig.add_subplot(1, 2, 2)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Vg2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;C1 Voltage&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Vg12</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;C2 Voltage&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">65</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;V(t) (V)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Voltages from Source 2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_20_0.png" src="../../_images/note-resonances-in-coupled-nanoantennas_20_0.png" />
</div>
</div>
<p>Next, we simply sum up both cases to find the total voltage on each capacitor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Vg1T</span> <span class="o">=</span> <span class="n">Vg1</span> <span class="o">+</span> <span class="n">Vg12</span>
<span class="n">Vg2T</span> <span class="o">=</span> <span class="n">Vg2</span> <span class="o">+</span> <span class="n">Vg21</span>

<span class="c1"># -- Plots -- </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Vg1T</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;C1 Voltage&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Vg2T</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;C2 Voltage&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">65</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;V(t) (V)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Total Voltages&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_22_0.png" src="../../_images/note-resonances-in-coupled-nanoantennas_22_0.png" />
</div>
</div>
<p>A particular application we are interested in is to drive the antennas with orthogonally-polarized waves, which in general define elliptical waves with varying ellipticity.  Note that at this example on the input, the waveforms of each source have a phase delay of 90 degrees, corresponding to circularly polarized light.  This model then corresponds to when each antenna is only sensitive to either the x- or y-polarized component.  Below we map the field pointing direction assuming it takes a 1:1 correspondence to the outgoing voltage waveforms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">135</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Vg1T</span><span class="p">,</span> <span class="n">Vg2T</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (fs)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;V(t) (V)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;V(t) (V)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Field Map&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_24_0.png" src="../../_images/note-resonances-in-coupled-nanoantennas_24_0.png" />
</div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<div class="docutils container" id="id6">
<dl class="citation">
<dt class="label" id="id938"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>)</span></dt>
<dd><p>Bernd Metzger, Mario Hentschel, Markus Lippitz, and Harald Giessen. Third-harmonic spectroscopy and modeling of the nonlinear response of plasmonic nanoantennas. <em>Optics Letters</em>, 37(22):4741–4743, November 2012. <a class="reference external" href="https://doi.org/10.1364/OL.37.004741">doi:10.1364/OL.37.004741</a>.</p>
</dd>
<dt class="label" id="id542"><span class="brackets">2</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>,<a href="#id4">3</a>)</span></dt>
<dd><p>Mario Hentschel, Tobias Utikal, Harald Giessen, and Markus Lippitz. Quantitative Modeling of the Third Harmonic Emission Spectrum of Plasmonic Nanoantennas. <em>Nano Letters</em>, 12(7):3778–3782, July 2012. <a class="reference external" href="https://doi.org/10.1021/nl301686x">doi:10.1021/nl301686x</a>.</p>
</dd>
<dt class="label" id="id1111"><span class="brackets">3</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>William P. Putnam, Richard G. Hobbs, Phillip D. Keathley, Karl K. Berggren, and Franz X. Kärtner. Optical-field-controlled photoemission from plasmonic nanoparticles. <em>Nature Physics</em>, 13(4):335–339, April 2017. <a class="reference external" href="https://doi.org/10.1038/nphys3978">doi:10.1038/nphys3978</a>.</p>
</dd>
<dt class="label" id="id705"><span class="brackets">4</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>P. D. Keathley, W. P. Putnam, P. Vasireddy, R. G. Hobbs, Y. Yang, K. K. Berggren, and F. X. Kärtner. Vanishing carrier-envelope-phase-sensitive response in optical-field photoemission from plasmonic nanoantennas. <em>Nature Physics</em>, 15(11):1128–1133, November 2019. <a class="reference external" href="https://doi.org/10.1038/s41567-019-0613-6">doi:10.1038/s41567-019-0613-6</a>.</p>
</dd>
<dt class="label" id="id129"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>Mina R. Bionta, Felix Ritzkowsky, Marco Turchetti, Yujia Yang, Dario Cattozzo Mor, William P. Putnam, Franz X. Kärtner, Karl K. Berggren, and Phillip D. Keathley. On-chip sampling of optical fields with attosecond resolution. <em>Nature Photonics</em>, 15(6):456–460, June 2021. <a class="reference external" href="https://doi.org/10.1038/s41566-021-00792-0">doi:10.1038/s41566-021-00792-0</a>.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./NOTE-2022-11-27-coupled-oscillators/ipynb"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../../NOTE-2022-04-12-surface-plasmon-polariton-mode-dispersion/ipynb/note.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Surface Plasmon Polariton Mode Dispersion with Derivation</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Donnie Keathley<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>