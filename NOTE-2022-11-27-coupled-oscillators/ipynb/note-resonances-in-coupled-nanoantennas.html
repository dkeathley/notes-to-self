
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Electrically-Coupled Nanoantenna Resonators &#8212; Technical Notes to Self</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Surface Plasmon Polariton Mode Dispersion with Derivation" href="../../NOTE-2022-04-12-surface-plasmon-polariton-mode-dispersion/ipynb/note.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Technical Notes to Self</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Technical Notes to Self
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../NOTE-2022-03-30-short-cable-impedance-tline-vs-lumped-element/ipynb/note.html">
   Short Cable Impedance â€“ T-Line vs. Lumped Element Approximation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../NOTE-2022-04-04-hemoglobin-refractive-index-vis-nir/ipynb/note.html">
   Kramers Kronig Analysis and Refractive Index of Hemoglobin/Red Blood Cells
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../NOTE-2022-04-12-surface-plasmon-polariton-mode-dispersion/ipynb/note.html">
   Surface Plasmon Polariton Mode Dispersion with Derivation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Electrically-Coupled Nanoantenna Resonators
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/dkeathley/notes-to-self/main?urlpath=tree/NOTE-2022-11-27-coupled-oscillators/ipynb/note-resonances-in-coupled-nanoantennas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/dkeathley/notes-to-self/blob/main/NOTE-2022-11-27-coupled-oscillators/ipynb/note-resonances-in-coupled-nanoantennas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/dkeathley/notes-to-self"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/dkeathley/notes-to-self/issues/new?title=Issue%20on%20page%20%2FNOTE-2022-11-27-coupled-oscillators/ipynb/note-resonances-in-coupled-nanoantennas.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/NOTE-2022-11-27-coupled-oscillators/ipynb/note-resonances-in-coupled-nanoantennas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivating-the-circuit-model">
   Motivating the Circuit Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transmission-line-simulation">
   Transmission Line Simulation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#but-first-a-note-on-units">
     But First: A Note on Units
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pulse-setup">
     Pulse Setup
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#excited-wave-at-single-antennas">
     Excited Wave At Single Antennas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connecting-with-a-transmission-line-initial-guess-as-twin-lead-t-line">
     Connecting With a Transmission Line: Initial Guess as Twin-Lead T-Line
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Electrically-Coupled Nanoantenna Resonators</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivating-the-circuit-model">
   Motivating the Circuit Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transmission-line-simulation">
   Transmission Line Simulation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#but-first-a-note-on-units">
     But First: A Note on Units
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pulse-setup">
     Pulse Setup
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#excited-wave-at-single-antennas">
     Excited Wave At Single Antennas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connecting-with-a-transmission-line-initial-guess-as-twin-lead-t-line">
     Connecting With a Transmission Line: Initial Guess as Twin-Lead T-Line
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="electrically-coupled-nanoantenna-resonators">
<h1>Electrically-Coupled Nanoantenna Resonators<a class="headerlink" href="#electrically-coupled-nanoantenna-resonators" title="Permalink to this headline">#</a></h1>
<p>In this note we explore two nanoantenna resonators that are electrically connected with similarly-scaled wires.  The approach is to capture the salient physics of the coupled resonant dynamics using effective circuit models.  This approach is motivated by the fact that one can model each antennaâ€™s resonance as a damped harmonic oscillator <span id="id1">[<a class="reference internal" href="../../NOTE-2022-04-04-hemoglobin-refractive-index-vis-nir/ipynb/note.html#id942" title="Bernd Metzger, Mario Hentschel, Markus Lippitz, and Harald Giessen. Third-harmonic spectroscopy and modeling of the nonlinear response of plasmonic nanoantennas. Optics Letters, 37(22):4741â€“4743, November 2012. doi:10.1364/OL.37.004741.">4</a>, <a class="reference internal" href="../../NOTE-2022-04-04-hemoglobin-refractive-index-vis-nir/ipynb/note.html#id546" title="Mario Hentschel, Tobias Utikal, Harald Giessen, and Markus Lippitz. Quantitative Modeling of the Third Harmonic Emission Spectrum of Plasmonic Nanoantennas. Nano Letters, 12(7):3778â€“3782, July 2012. doi:10.1021/nl301686x.">5</a>, <a class="reference internal" href="../../NOTE-2022-04-04-hemoglobin-refractive-index-vis-nir/ipynb/note.html#id1115" title="William P. Putnam, Richard G. Hobbs, Phillip D. Keathley, Karl K. Berggren, and Franz X. KÃ¤rtner. Optical-field-controlled photoemission from plasmonic nanoparticles. Nature Physics, 13(4):335â€“339, April 2017. doi:10.1038/nphys3978.">6</a>, <a class="reference internal" href="../../NOTE-2022-04-04-hemoglobin-refractive-index-vis-nir/ipynb/note.html#id709" title="P. D. Keathley, W. P. Putnam, P. Vasireddy, R. G. Hobbs, Y. Yang, K. K. Berggren, and F. X. KÃ¤rtner. Vanishing carrier-envelope-phase-sensitive response in optical-field photoemission from plasmonic nanoantennas. Nature Physics, 15(11):1128â€“1133, November 2019. doi:10.1038/s41567-019-0613-6.">7</a>]</span>.  We see that this can be modeled by an RLC circuit in series with the intuition that the external optical fields drive the system.</p>
<p>In the following, we start with development of the effective circuit model and provide physical motivation. We build up from a single antenna, to two coupled antennas that are attached via twin leads.  We then drive the system and study the outputs to investigate the physics, and explore how coupling impacts the resulting local fields at each antenna.</p>
<section id="motivating-the-circuit-model">
<h2>Motivating the Circuit Model<a class="headerlink" href="#motivating-the-circuit-model" title="Permalink to this headline">#</a></h2>
<p>We can imagine that charges oscillate in the antenna structure as driven the the exciting E-field.  In <a class="reference internal" href="#fig-single-antenna-rlc"><span class="std std-numref">Fig. 1</span></a> we a point of maximum charge separation and the resulting external field lines.  The external field lines lead to a capacitive coupling between the top and bottom of the antenna.  Furthermore, as the charges move through the antenna, there is loss and induction.  This leads to the effective circuit model on the right.  The electric field waveform can be mapped directly to an effective voltage waveform that drives the effective RLC in series.</p>
<figure class="align-default" id="fig-single-antenna-rlc">
<a class="reference internal image-reference" href="../../_images/single-antenna-rlc.png"><img alt="../../_images/single-antenna-rlc.png" src="../../_images/single-antenna-rlc.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">The effective circuit model for a single antenna.</span><a class="headerlink" href="#fig-single-antenna-rlc" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Note that as the capacitance maps directly to the fields surrounding the antenna structure, we interpret that the fields surrounding the antenna structure should map with a one-to-one correspondence with the voltage on the capacitor.  Indeed, we find that the voltage on the capacitance can be written as:</p>
<div class="math notranslate nohighlight">
\[ V_C = \frac{\tilde{V}(\omega)}{1 - \omega^2 C L + j\omega C R} \mathrm{.}\]</div>
<p>This then relates directly to the known enhanced field response at the tip for instance which can be expressed as</p>
<div class="math notranslate nohighlight">
\[ E_\mathrm{tip} \propto \frac{\tilde{E}_\mathrm{inc}(\omega)}{\omega_\mathrm{res}^2 - \omega^2 - j\omega/\tau} \mathrm{,} \]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is the damping time and <span class="math notranslate nohighlight">\(\omega_\mathrm{res}\)</span> the resonance frequency of the oscillator.</p>
<p>Interestingly, one might think that adding in new elements would make the situation significantly more complicated.  Consider the addition of a wire at the bottom of the antenna tip as shown in <a class="reference internal" href="#fig-single-antenna-wire-rlc"><span class="std std-numref">Fig. 2</span></a>.</p>
<figure class="align-default" id="fig-single-antenna-wire-rlc">
<a class="reference internal image-reference" href="../../_images/antenna-wire-rlc.png"><img alt="../../_images/antenna-wire-rlc.png" src="../../_images/antenna-wire-rlc.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">The effective circuit model for a single antenna with a wire.</span><a class="headerlink" href="#fig-single-antenna-wire-rlc" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Here, we can roughly define three regions with effective capacitance, now considering the system with the wire coupled to it.  There is the body capacitance <span class="math notranslate nohighlight">\(C_\mathrm{B}\)</span>, the wire to body capacitance <span class="math notranslate nohighlight">\(C_\mathrm{W}\)</span> and the tip to wire gap capacitance <span class="math notranslate nohighlight">\(C_\mathrm{g}\)</span>. We realize this is already simplified in ignoring any resistance or inductance in the wire itself.</p>
<p>Since we are usually concerning ourselves with the enhanced fields in the gap of the antenna for applications, we can solve for those by then solving for <span class="math notranslate nohighlight">\(V_\mathrm{g}\)</span> the voltage on <span class="math notranslate nohighlight">\(C_\mathrm{g}\)</span>.  With a bit of work we find this is expressed as:</p>
<div class="math notranslate nohighlight">
\[ \tilde{V}_\mathrm{g}(\omega) = \frac{\tilde{V}(\omega)}{j \omega AC_\mathrm{g}R - \omega^2 A L C_\mathrm{g}
     + C_\mathrm{g}/C_\mathrm{b} (A - 1) } \]</div>
<p>Note that to within a constant multiple, this can be rewritten as the response of an RLC in series, thus significantly simplifying our problem.  This justifies latersubstitutions where we switch to an effective RLC model despite the addition of collector wires.</p>
</section>
<section id="transmission-line-simulation">
<h2>Transmission Line Simulation<a class="headerlink" href="#transmission-line-simulation" title="Permalink to this headline">#</a></h2>
<p>Now that we have the effective circuit models for the individual resonators, we can add the next layer of coplexity: the connecting wires.  These wires behave more like transmission lines as they can couple traveling waves.  This is important as if the wires get longer, they can cary waves over a macroscopic distance.  This induces a propagation delay that coudl be observed.  Also, it leads to a different profile in the resonant waveform that gets induced across both sets of antennas.</p>
<p>Here we model a pair of antennas connected via a transmission line.  The antennas follow the coupled oscillator approach similar to above.  However, now, instead of a lumped element coupler, we use a finite-length transmission-line coupler between the antenna pair.</p>
<p>A sketch of the physical device and its effective circuit model that we will use are shown in <a class="reference internal" href="#fig-effective-t-line-ckt"><span class="std std-numref">Fig. 3</span></a>.</p>
<figure class="align-default" id="fig-effective-t-line-ckt">
<a class="reference internal image-reference" href="../../_images/t-line-effective-ckt.png"><img alt="../../_images/t-line-effective-ckt.png" src="../../_images/t-line-effective-ckt.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">An effective circuit for two coupled oscillators connected by a transmission line.  Forward and backward waves create reflection effects, and couple the two oscillators together.</span><a class="headerlink" href="#fig-effective-t-line-ckt" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>We emphasize here that the two RLC models are effective circuit parameters.  While this may seem very simplified, it is incredibly powerful.  Several past works <span id="id2">[<a class="reference internal" href="../../NOTE-2022-04-04-hemoglobin-refractive-index-vis-nir/ipynb/note.html#id942" title="Bernd Metzger, Mario Hentschel, Markus Lippitz, and Harald Giessen. Third-harmonic spectroscopy and modeling of the nonlinear response of plasmonic nanoantennas. Optics Letters, 37(22):4741â€“4743, November 2012. doi:10.1364/OL.37.004741.">4</a>, <a class="reference internal" href="../../NOTE-2022-04-04-hemoglobin-refractive-index-vis-nir/ipynb/note.html#id546" title="Mario Hentschel, Tobias Utikal, Harald Giessen, and Markus Lippitz. Quantitative Modeling of the Third Harmonic Emission Spectrum of Plasmonic Nanoantennas. Nano Letters, 12(7):3778â€“3782, July 2012. doi:10.1021/nl301686x.">5</a>]</span>, including those of ours <span id="id3">[<a class="reference internal" href="../../NOTE-2022-04-04-hemoglobin-refractive-index-vis-nir/ipynb/note.html#id1115" title="William P. Putnam, Richard G. Hobbs, Phillip D. Keathley, Karl K. Berggren, and Franz X. KÃ¤rtner. Optical-field-controlled photoemission from plasmonic nanoparticles. Nature Physics, 13(4):335â€“339, April 2017. doi:10.1038/nphys3978.">6</a>, <a class="reference internal" href="../../NOTE-2022-04-04-hemoglobin-refractive-index-vis-nir/ipynb/note.html#id709" title="P. D. Keathley, W. P. Putnam, P. Vasireddy, R. G. Hobbs, Y. Yang, K. K. Berggren, and F. X. KÃ¤rtner. Vanishing carrier-envelope-phase-sensitive response in optical-field photoemission from plasmonic nanoantennas. Nature Physics, 15(11):1128â€“1133, November 2019. doi:10.1038/s41567-019-0613-6.">7</a>]</span>, have shown that the fields that build up on the capictive element can be tuned to quantitatively predict the temporal profile of a plasmonic resonator. All of the paramters can be fit phenomenologically based on comparisons to experimental and/or simulation data.  Wherever possible, though, we motivate parameter choices using first-principles.</p>
<p>Below we outline our procedure for modeling the coupled resonators, including the selection of effective parameters for the circuit models.  This analysis can easily be extended, and full-wave simulations and experimental data can be used to tune-in the effective system parameters.</p>
<section id="but-first-a-note-on-units">
<h3>But First: A Note on Units<a class="headerlink" href="#but-first-a-note-on-units" title="Permalink to this headline">#</a></h3>
<p>For convenience in all of the code below we use a modified unit system defined using the natural length scales of the problem: nanometers and femtoseconds.  Where relevant we denote the nm-fs units are denoted as SI units with an n subscript.</p>
<p>This nm-fs unit system leads to the conversions shown in <a class="reference internal" href="#nm-fs-conversion-table"><span class="std std-numref">Table 1</span></a></p>
<table class="colwidths-auto table" id="nm-fs-conversion-table">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Conversion from SI to nm-fs units for the calculations that follow.</span><a class="headerlink" href="#nm-fs-conversion-table" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>SI Unit</p></th>
<th class="head"><p>nm-fs units</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Capacitance</p></td>
<td><p>F</p></td>
<td><p><span class="math notranslate nohighlight">\(10^{12}\)</span> F<sub>n</sub></p></td>
</tr>
<tr class="row-odd"><td><p>Inductance</p></td>
<td><p>H</p></td>
<td><p><span class="math notranslate nohighlight">\(10^{18}\)</span> H<sub>n</sub></p></td>
</tr>
<tr class="row-even"><td><p>Resistance</p></td>
<td><p><span class="math notranslate nohighlight">\(\Omega\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10^{3}\)</span> <span class="math notranslate nohighlight">\(\Omega\)</span><sub>n</sub></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\epsilon_0\)</span></p></td>
<td><p>F/m</p></td>
<td><p><span class="math notranslate nohighlight">\(10^{3}\)</span> F<sub>n</sub>/nm</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mu_0\)</span></p></td>
<td><p>H/m</p></td>
<td><p><span class="math notranslate nohighlight">\(10^{9}\)</span> H<sub>n</sub>/nm</p></td>
</tr>
</tbody>
</table>
</section>
<section id="pulse-setup">
<h3>Pulse Setup<a class="headerlink" href="#pulse-setup" title="Permalink to this headline">#</a></h3>
<p>We start by defining a waveform to drive each antenna.  These are defined as <span class="math notranslate nohighlight">\(V_1(t)\)</span> and <span class="math notranslate nohighlight">\(V_2(t)\)</span> for antenna 1 and antenna 2. These voltage waveforms are directly proportional to the incident electric field driving the antennas.  Below, we sert the pulses so that they more closely match what we are experimentally capable of generating in our laboratory, but these could of course be tuned for any duration and wavelength.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
import matplotlib.pyplot as plt


import sys
sys.path.append(&#39;../includes&#39;)
import pulse_functions as pulses

# -- Constants -- 
c = 300 #Speed of light in nm/fs
eps0 = 8.85418782e-12*1e3 #permittivity of freespace in nm, fs units
mu0 = 1.25663706e-6*1e9 #permeability of freespace in nm, fs units

# -- Settings -- 

#Time axis in femtoseconds
t = np.linspace(-1000, 1000, 100000)

#FWHM in fs
fwhm = 12 

#Central wavelength in nm
yc = 1170 

#Phase delay
phaseDelay = -1*np.pi/2

# ------------------------------

# -- Calculations -- 
fc = c/yc
wc = 2*np.pi*fc

#Incident pulses for each side:
V1 = 1.0*pulses.cos2pulse(t, fwhm, wc, 0)[&#39;E&#39;]
V2 = 1.0*pulses.cos2pulse(t, fwhm, wc, phaseDelay)[&#39;E&#39;]


# -- Plots -- 
fig = plt.figure()
fig.set_size_inches(10, 7)

plt.plot(t, V1, t, V2)
plt.xlim(-40, 40);
plt.xlabel(&#39;Time (fs)&#39;, fontsize=14)
plt.ylabel(&#39;V(t) (V)&#39;, fontsize=14)
plt.tick_params(labelsize=13)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_11_0.png" src="../../_images/note-resonances-in-coupled-nanoantennas_11_0.png" />
</div>
</div>
</section>
<section id="excited-wave-at-single-antennas">
<h3>Excited Wave At Single Antennas<a class="headerlink" href="#excited-wave-at-single-antennas" title="Permalink to this headline">#</a></h3>
<p>Now we examine the excited wave at the antenna given no transmission line (i.e. no coupling between the resonators). The field at the antenna is diretly proportional to the voltage waveform on the capacitor, which is what we study here.</p>
<p>The parameters that we set, which are based on actual experimenta nd electromagnetic simulation, are the decay time <span class="math notranslate nohighlight">\(\tau\)</span> and the resonance wavelength <span class="math notranslate nohighlight">\(\lambda_\mathrm{res}\)</span>.  We also set an effective capacitance.  This value is based on static examinations of the device capacitance, but can be adjusted for fits later when applying the transmission line.  This is important as it sets an effective load impedance that is part of setting the reflectivity at the connection point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>tau1 = 5
yres1 = 1100
C1 = 10e-18*1e12

tau2 = 5
yres2 = 1100
C2 = 10e-18*1e12

# -- Calculations -- 
dt = t[1] - t[0]
w = np.fft.fftfreq(t.size, d=dt)*2*np.pi

w[np.where(w == 0)[0]] = 1e-18

wres1 = 2*np.pi*c/yres1
L1 = 1/(wres1**2*C1)
R1 = 1/(wres1**2*tau1*C1)
V1f = np.fft.fft(V1)
Vin1f = V1f/(1 - w**2*C1*L1 + 1j*w*C1*R1)
Vin1 = np.real(np.fft.ifft(Vin1f))

wres2 = 2*np.pi*c/yres2
L2 = 1/(wres1**2*C2)
R2 = 1/(wres1**2*tau1*C2)
V2f = np.fft.fft(V2)
Vin2f = V2f/(1 - w**2*C2*L2 + 1j*w*C2*R2)
Vin2 = np.real(np.fft.ifft(Vin2f))

# -- Plots -- 
fig = plt.figure()
fig.set_size_inches(15, 7)

ax1 = fig.add_subplot(1, 2, 1)
ax2 = fig.add_subplot(1, 2, 2)

ax1.plot(t, V1/np.abs(V1).max(), label=&#39;input&#39;)
ax1.plot(t, Vin1/np.abs(Vin1).max(), label=&#39;excited&#39;)
ax1.set_xlim(-20, 40)

ax2.plot(t, V2/np.abs(V2).max(), label=&#39;input&#39;);
ax2.plot(t, Vin2/np.abs(Vin2).max(), label=&#39;excited&#39;)
ax2.set_xlim(-20, 40);

ax1.set_xlabel(&#39;Time (fs)&#39;, fontsize=14)
ax1.set_ylabel(r&#39;$V_\mathrm{g}(t)$ (V)&#39;, fontsize=14)
ax1.tick_params(labelsize=13)
ax1.set_title(&#39;Left Resonator Waveforms&#39;, fontsize=15)
ax1.legend(fontsize=14)

ax2.set_xlabel(&#39;Time (fs)&#39;, fontsize=14)
ax2.set_ylabel(r&#39;$V_\mathrm{g}(t)$ (V)&#39;, fontsize=14)
ax2.tick_params(labelsize=13)
ax2.set_title(&#39;Right Resonator Waveforms&#39;, fontsize=15);
ax2.legend(fontsize=14);
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_14_0.png" src="../../_images/note-resonances-in-coupled-nanoantennas_14_0.png" />
</div>
</div>
</section>
<section id="connecting-with-a-transmission-line-initial-guess-as-twin-lead-t-line">
<h3>Connecting With a Transmission Line: Initial Guess as Twin-Lead T-Line<a class="headerlink" href="#connecting-with-a-transmission-line-initial-guess-as-twin-lead-t-line" title="Permalink to this headline">#</a></h3>
<p>Now we are going to connect the two antennas with a transmission line.  We will start with the approximation of the wire as a twin-lead T-line.</p>
<p>For this we need to calculate the reflectivity <span class="math notranslate nohighlight">\(\Gamma\)</span>, the effective impedance <span class="math notranslate nohighlight">\(Z_0\)</span>, and the propagation constant <span class="math notranslate nohighlight">\(\beta\)</span> from the twin-lead equations.  These were taken from <a class="reference external" href="https://eng.libretexts.org/Bookshelves/Electrical_Engineering/Electro-Optics/Book%3A_Electromagnetics_II_(Ellingson)/07%3A_Transmission_Lines_Redux/7.01%3A_Parallel_Wire_Transmission_Line">here</a> for reference.  While this is a simplified formalism, it captures the general physics quite well, and the waveforms we see bear a striking resemblance already to those from full-wave simulations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># -- Settings -- 
D = 200 #wire spacing
d = 20 #wire width
l = 700 #wire length
epsr = 1.5 #Effective permittivity

alpha = 1/3000 #loss parameter
#alpha = 1 #High loss -- no coupling

P1 = 0.5 #Amount of R and L the line sees
P2 = 0.5

# -- Calculations -- 
Lp = (mu0/np.pi)*np.log((D/d) + np.sqrt((D/d)**2 - 1))
Cp = np.pi*eps0*epsr/np.log((D/d) + np.sqrt((D/d)**2 - 1))

#Split impedances:
Rt1 = (1 - P1)*R1
Rb1 = P1*R1
Lt1 = (1 - P1)*L1
Lb1 = P1*L1

Zt1 = Rt1 + 1j*w*Lt1
Zb1 = Rb1 + 1j*w*Lb1 + 1/(1j*w*C1)

Rt2 = (1 - P2)*R2
Rb2 = P2*R2
Lt2 = (1 - P2)*L2
Lb2 = P2*L2

Zt2 = Rt2 + 1j*w*Lt2
Zb2 = Rb2 + 1j*w*Lb2 + 1/(1j*w*C2)

#Line impedance and velocity
Z0 = np.sqrt(Lp/Cp) #impedance
v = 1/np.sqrt(Lp*Cp) #velocity
beta = w/v #propagation constant

print(Lp)
print(Cp)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1197.28913708245
1.3939616011958852e-08
</pre></div>
</div>
</div>
</div>
<p>After determining all of the transmission line characteristics, we now move forward to calculating the voltage response at each antenna with the transmission line in place.</p>
<p>Since the system is linear, we do this calculation twice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#Load impedance at 2 as seen by source at 1

ZL1 = Zt2*Zb2/(Zt2 + Zb2)

Gamma1 = (ZL1 - Z0)/(ZL1 + Z0)

Zin1 = Z0*(1 + Gamma1*np.exp(-1j*2*beta*l)*np.exp(-2*alpha*l))/(1 - Gamma1*np.exp(-1j*2*beta*l)*np.exp(-2*alpha*l))

Zp1 = Zb1*Zin1/(Zb1 + Zin1)

Vin1f = V1f*Zp1/(Zt1 + Zp1)

Vplus1f = Vin1f/(np.exp(1j*beta*l)*np.exp(alpha*l) + Gamma1*np.exp(-1j*beta*l)*np.exp(-1*alpha*l))
Vo21f = Vplus1f*(1 + Gamma1)

Vg1f = Vin1f/(1 + 1j*w*C1*(Rb1 + 1j*w*Lb1))
Vg21f = Vo21f/(1 + 1j*w*C2*(Rb2 + 1j*w*Lb2))

Vg1 = np.real(np.fft.ifft(Vg1f))
Vg21 = np.real(np.fft.ifft(Vg21f))

# -- Plots -- 
fig = plt.figure()
fig.set_size_inches(15, 7)

ax1 = fig.add_subplot(1, 1, 1)
# ax2 = fig.add_subplot(1, 2, 2)

# ax1.plot(t, V1/np.abs(V1).max())
ax1.plot(t, Vg1)
ax1.plot(t, -1*Vg21)
ax1.set_xlim(-20, 200)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-20.0, 200.0)
</pre></div>
</div>
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_19_1.png" src="../../_images/note-resonances-in-coupled-nanoantennas_19_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#Load impedance at 2 as seen by source at 1

ZL2 = Zt1*Zb1/(Zt1 + Zb1)

Gamma2 = (ZL2 - Z0)/(ZL2 + Z0)

Zin2 = Z0*(1 + Gamma2*np.exp(-1j*2*beta*l)*np.exp(-2*alpha*l))/(1 - Gamma2*np.exp(-1j*2*beta*l)*np.exp(-2*alpha*l))

Zp2 = Zb2*Zin2/(Zb2 + Zin2)

Vin2f = V2f*Zp2/(Zt2 + Zp2)

Vplus2f = Vin2f/(np.exp(1j*beta*l)*np.exp(alpha*l) + Gamma2*np.exp(-1j*beta*l)*np.exp(-1*alpha*l))
Vo12f = Vplus2f*(1 + Gamma2)

Vg2f = Vin2f/(1 + 1j*w*C2*(Rb2 + 1j*w*Lb2))
Vg12f = Vo12f/(1 + 1j*w*C1*(Rb1 + 1j*w*Lb1))

Vg2 = np.real(np.fft.ifft(Vg2f))
Vg12 = np.real(np.fft.ifft(Vg12f))

# -- Plots -- 
fig = plt.figure()
fig.set_size_inches(15, 7)

ax1 = fig.add_subplot(1, 1, 1)
# ax2 = fig.add_subplot(1, 2, 2)

# ax1.plot(t, V1/np.abs(V1).max())
ax1.plot(t, Vg2)
ax1.plot(t, -1*Vg12)
ax1.set_xlim(-50, 100)


# ax2.plot(t, V2/np.abs(V2).max(), t, Vin2/np.abs(Vin2).max())
# ax2.set_xlim(-20, 40);
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-50.0, 100.0)
</pre></div>
</div>
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_20_1.png" src="../../_images/note-resonances-in-coupled-nanoantennas_20_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>Vg1T = Vg1 + Vg12
Vg2T = Vg2 + Vg21

# -- Plots -- 
fig = plt.figure()
fig.set_size_inches(15, 7)

ax1 = fig.add_subplot(1, 1, 1)

ax1.plot(t, Vg1T)
ax1.plot(t, -1*Vg2T)
ax1.set_xlim(-50, 100)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-50.0, 100.0)
</pre></div>
</div>
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_21_1.png" src="../../_images/note-resonances-in-coupled-nanoantennas_21_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure()
fig.set_size_inches(10, 7)

ax = plt.axes(projection=&#39;3d&#39;)
ax.view_init(10, 135)

ax.plot3D(t, Vg1T, Vg2T)
ax.set_xlim(-50, 100)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-50.0, 100.0)
</pre></div>
</div>
<img alt="../../_images/note-resonances-in-coupled-nanoantennas_22_1.png" src="../../_images/note-resonances-in-coupled-nanoantennas_22_1.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./NOTE-2022-11-27-coupled-oscillators/ipynb"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../../NOTE-2022-04-12-surface-plasmon-polariton-mode-dispersion/ipynb/note.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Surface Plasmon Polariton Mode Dispersion with Derivation</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Donnie Keathley<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>